configurations {
    war
}

dependencies {
    compile project(':tomcat-embedded-launcher')

    runtime("org.alfresco:alfresco-repository:$alfrescoVersion:h2scripts") {
        transitive = false
    }
    runtime 'com.h2database:h2:1.4.192'

    war "org.alfresco:alfresco:$alfrescoVersion:@war"
}

def webapp = "$buildDir/webapps/alfresco"

task extractWar(type: Copy) {
    from {
        configurations.war.collect { zipTree(it) }
    }
    into webapp
}

task startTomcat(type: JavaExec, dependsOn: ['extractWar', ':jar']) {
    classpath = sourceSets.main.runtimeClasspath
    main = 'xyz.its_me.alfresco.Launcher'
    args = [webapp, "${rootProject.buildDir}/libs"]
}
